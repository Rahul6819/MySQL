SQL Lab 3 ES23BTECH11015

CREATE TABLE Students (
    roll INT PRIMARY KEY,
    s_name VARCHAR(25) NOT NULL,
    email VARCHAR(30) UNIQUE,
    department VARCHAR(20),
    total_credits INT
);

CREATE TABLE Faculties (
    ID INT PRIMARY KEY,
    f_name VARCHAR(50) NOT NULL,
    department VARCHAR(50),
    salary int
);

CREATE TABLE Mentorship (
    roll INT,
    faculty_id INT,
    starting_date DATE,
    PRIMARY KEY (roll, faculty_id),
    FOREIGN KEY (roll) REFERENCES Students(roll),
    FOREIGN KEY (faculty_id) REFERENCES Faculties(ID)
);



SELECT Students.roll, Students.s_name, Faculties.f_name, Mentorship.starting_date
FROM Students 
LEFT JOIN Mentorship ON Students.roll = Mentorship.roll
LEFT JOIN Faculties ON Mentorship.faculty_id = Faculties.ID
ORDER BY Students.roll;

SELECT St.roll, St.s_name
FROM Students St
JOIN Mentorship M ON St.roll = M.roll
GROUP BY St.roll, St.s_name
HAVING COUNT(M.faculty_id) > 1;


SELECT COUNT(DISTINCT F.ID)
FROM Faculties F
JOIN Mentorship M ON F.ID = M.faculty_id
GROUP BY F.ID
HAVING COUNT(DISTINCT M.roll) >= 3;


SELECT DISTINCT Fa.f_name
FROM Faculties Fa
JOIN Mentorship M ON Fa.ID = M.faculty_id
JOIN Students St ON St.roll = M.roll
WHERE St.department != 'CSE';

